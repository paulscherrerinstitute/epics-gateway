<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>CAESAR - Standard Operations</title>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link href="/Less/main.css" rel="stylesheet" />
    <style>
        body
        {
            overflow: auto;
        }
    </style>
</head>
<body>
    <div class="helpMiddleContainer">
        <h1>Operation Manual</h1>
        <h2>Topics</h2>

        <h2>A gateway doesn't respond</h2>
        Follow the following procedure:
        <ol>
            <li><a href="#identify_gateway">Identify the true gateway having issues</a></li>
            <li><a href="#identify_issue">Identify the kind of issue</a></li>
            <li><a href="#standard_restart">Restart the needed gateway from CAESAR</a></li>
            <li><a href="#wont_restart">If CAESAR restart doesn't work restart VM</a></li>
            <li><a href="#report_incident">How to report an incident</a></li>
        </ol>

        <h2 id="identify_gateway">Identify the true gateway having issues</h2>
        To identify issues with gateways the easiest way is by using the CAESAR map (from the top bar &rArr; Map).
        The map should look like this one <span class="fig">1</span> in case everything works as expected.<br />
        <figure>
            <img src="/Images/all_green_map.png" />
            <figcaption>Fig 1. - All ok</figcaption>
        </figure>
        If one gateway is not working as expected it will be displayed with a RED background <span class="fig">2</span>.
        <figure>
            <img src="/Images/proscan_red.png" />
            <figcaption>Fig 2. - Gateway error</figcaption>
        </figure>
        Due to the position of CAESAR (this monitoring tool) within the network, if a machine gateway fails, not only the machine
        gateway will be shown in red but all the gateways behind it <span class="fig">3</span>.<br />
        <figure>
            <img src="/Images/sf_red.png" />
            <figcaption>Fig 3. - Cascading errors</figcaption>
        </figure>
        In this case, take the gateway nearest the CAESAR server as the gulty one.<br />
        <br />
        By clicking on one of the gateways on the map, the view will change and the Gateway details will be displayed.
        <h2 id="identify_issue">Identify the kind of issue</h2>
        It is possible to view the gateway details by:
        <ul>
            <li>From the status page and selecting one gateway.</li>
            <li>From the map page and selecting one gateway.</li>
            <li>Selecting the gateway in error on the "Errors" pane.</li>
        </ul>

        <figure>
            <img src="/Images/details.png" />
            <figcaption>Fig. 4 - Detailed Graphs</figcaption>
        </figure>

        The details page contains 4 graphs allowing to have an overview  of the last minutes of the gateway as well
        as the current values on the right side.<br />
        <br />
        A non responding gateway will show all the 4 graphs with the values set at 0 as well as the current values set either to 0 or to null <span class="fig">5</span> <span class="actionToDo">Either wait for an automatic restart or restart manually.</span><br />
        <figure>
            <img src="/Images/bad_gateway.png" />
            <figcaption>Fig. 5 - Bad gateway</figcaption>
        </figure>

        If the graph shows continous up &amp; down of the gateway <span class="fig">6</span>, then it is usually sign a client is killing the gateway: <span class="actionToDo">
            in this case create a
            "Service Now" ticket with as much details as possible.
        </span>

        <figure>
            <img src="/Images/bad_cycles.png" />
            <figcaption>Fig. 6 - Restart in cycles</figcaption>
        </figure>

        In case of high CPU load, the watchdog running on the gateway will trigger a restart every now and then <span class="fig">7</span>.
        <figure>
            <img src="/Images/high_cpu.png" />
            <figcaption>Fig 7. - High CPU</figcaption>
        </figure>
        In case of high CPU load, which repeats itself in cycles, it's again a sign of one or more clients requesting too much from the gateway.
        <span class="actionToDo">As before, in this case, create a ticket in "Service Now" with as much details as possible.</span>

        <h2 id="standard_restart">Restart the needed gateway from CAESAR</h2>
        From the corresponding getway detail page, it's possible to restart the gateway. Press simply the "Restart Gateway" button
        and wait a couple of seconds. The "RunningTime" should reset and start counting again.

        <h2 id="wont_restart">If CAESAR restart doesn't work restart VM</h2>
        If the standard CAESAR restart doesn't work and either the gateway doesn't come back or the timer doesn't reset, then a full VM restart is
        required. Check the Picket information for a full VM restart. Gateway VMs have the same name as the gateways on CAESAR.

        <h2 id="report_incident">How to report an incident</h2>
        <a href="https://psi.service-now.com/psisp?id=psi_new_report_incident" target="_blank">Use "Service Now" (css.psi.ch) to report any incidents.</a>
        Incidents requires the following information:<br />
        <ol>
            <li>In the subject: EPICS Gateway &lt;gateway name&gt;</li>
            <li>Gateway name</li>
            <li>Date and time of the issue</li>
            <li>Who reported / saw it at first</li>
            <li>What doesn't seems to work</li>
            <li>Which action has been done</li>
        </ol>
    </div>
</body>
</html>