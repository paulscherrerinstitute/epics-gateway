<!DOCTYPE html>
<html>
<head>
    <base href="/" />
    <meta charset="utf-8" />
    <meta name="google" content="notranslate">
    <title>EPICS Gateway Logger</title>
    <link href="styles/kendo.common.min.css" rel="stylesheet" />
    <link href="styles/kendo.material.min.css" rel="stylesheet" />
    <link href="Less/main.css" rel="stylesheet" />
</head>
<body>
    <ul class="tabs" id="mainTabs">
        <li><div class="hamburger"><div></div><div></div><div></div></div></li>
        <li class="activeTab">Status</li>
        <li>Logs</li>
        <li style="float: right;">Help</li>
    </ul>
    <div id="gatewayView">
        <div id="gatewayBeamlines">
            <div class="GWDisplay" id="X01DC-CAGW02"></div>
            <div class="GWDisplay" id="X02DA-CAGW02"></div>
            <div class="GWDisplay" id="X03DA-CAGW02"></div>
            <div class="GWDisplay" id="X03MA-CAGW02"></div>
            <div class="GWDisplay" id="X04DB-CAGW02"></div>
            <div class="GWDisplay" id="X04SA-CAGW02"></div>
            <div class="GWDisplay" id="X05DA-CAGW02"></div>
            <div class="GWDisplay" id="X05LA-CAGW02"></div>
            <div class="GWDisplay" id="X06DA-CAGW02"></div>
            <div class="GWDisplay" id="X06MX-CAGW"></div>
            <div class="GWDisplay" id="X06SA-CAGW02"></div>
            <div class="GWDisplay" id="X07DA-CAGW02"></div>
            <div class="GWDisplay" id="X07MA-CAGW02"></div>
            <div class="GWDisplay" id="X09LA-CAGW02"></div>
            <div class="GWDisplay" id="X09LB-CAGW02"></div>
            <div class="GWDisplay" id="X10DA-CAGW02"></div>
            <div class="GWDisplay" id="X10SA-CAGW02"></div>
            <div class="GWDisplay" id="X11MA-CAGW02"></div>
            <div class="GWDisplay" id="X12SA-CAGW02"></div>

            <div class="GWDisplay" id="SFES-CAGW"></div>

            <div class="GWDisplay" id="TESTCAGW01"></div>
            <div class="GWDisplay" id="TESTCAGW02"></div>
        </div>

        <div id="gatewayMains">
            <div class="GWDisplay" id="SLS-CAGW02"></div>

            <div class="GWDisplay" id="FIN-CAGW02"></div>
            <div class="GWDisplay" id="SF-CAGW"></div>

            <div class="GWDisplay" id="HIPA-CAGW02"></div>

            <div class="GWDisplay" id="PROSCAN-CAGW02"></div>

            <div class="GWDisplay" id="CRYO-CAGW02"></div>
        </div>
    </div>
    <div id="gatewayDetails">
        <div id="graphs">
            <h2 id="cpuGraphTitle">CPU:</h2>
            <div id="cpuGraph"></div>
            <h2 id="searchGraphTitle">Searches:</h2>
            <div id="searchesGraph"></div>
            <h2 id="pvsGraphTitle">PVs:</h2>
            <div id="pvsGraph"></div>
        </div>
        <div id="infos">
            <h2 id="currentGW"></h2>
            <table id="gwInfos"></table>
            <div id="detailsButtons">
                <a id="logLink" class="button" href="">Logs</a>
                <a id="inventoryLink" class="button" target="_blank" href="">Check configuration</a>
                <a class="button" href="/">Close</a>
            </div>
        </div>
    </div>
    <div id="logView">
        <div id="sessionSelector">
            <span class="title">Gateway:</span>
            <select id="gatewaySelector" class="gatewaySelector"></select>
            <span class="title">Sessions:</span>
            <div id="gatewaySessions"></div>
        </div>
        <div id="timeRange"><div id="prevDay"></div><canvas id="timeRangeCanvas"></canvas><div id="nextDay"></div></div>
        <div id="fields">
            <span id="">Start time:</span>
            <input type="text" id="startDate" class="dateInputs" />
            <span id="">End time:</span>
            <input type="text" id="endDate" class="dateInputs" />
        </div>
        <input type="text" id="queryField" placeholder="Type your query here..." class="k-textbox" />
        <div id="clients"><div id="clientsContent" class="listContent"></div></div>
        <div id="servers"><div id="serversContent" class="listContent"></div></div>
        <div id="logs">
            <ul class="tabs" id="logFilter">
                <li class="activeTab" level="0,1,2,3,4">All</li>
                <li level="2">Connections</li>
                <li level="3,4">Errors</li>
                <li report="SearchesPerformed" query="remote starts '{0}'" split=":">Srch / Clients</li>
                <li report="SearchesOnChannelsPerformed" query="channel = '{0}'">Srch / Channels</li>
                <li report="MostActiveClasses" query="class contains '{0}'" split=".">Log Class</li>
            </ul>
            <div id="logsContent" class="listContent"></div>
        </div>
        <div id="utcTime"></div>
        <div id="bufferSpace"></div>
        <div id="freeSpace"></div>
        <div id="querySuggestions"></div>
        <div id="detailInfo"></div>
        <div id="showLastBtn">Last entries</div>
        <div id="mouseCapture"></div>
    </div>
    <div id="reportView">
        <div class="button topClose" onclick="$('#reportView').hide();">Close</div>
        <div id="reportContent" class="fixed"></div>
    </div>
    <div id="errorsView"><div id="errorsContent"></div></div>
    <div id="helpView">
        <div id="helpContent">
            <h1>Welcome to the EPICS Gateway Monitor &amp; Log Analyzer</h1>
            <h2>How to use it:</h2>
            On top most of the interface some tabs are available (Status, Logs, Help). By clicking on them the interface switch in the different modes.

            <h3>Status</h3>
            The status page allows to get an overview in near real time (updates every 2 seconds) of all the EPICS gateways.
            Each gateway is displayed with a gray circle and some values in the middle, as well as the gateway name under the circle.
            Over the gray circle 2 arcs may appear of different colors. The most external one shows the CPU in percent form, while
            the inner arc one shows number of searches per seconds the gateway receives (up to 100).<br />
            <br />
            By clicking on the gateway, more details of the gateway will be displayed.
            <h3>Logs</h3>
            <ul>
                <li>Select the gateway you want to check on the top left side. The gateway sessions are then loaded and displayed on the left bar,
                as well as the statistics are displayed on the time range widget.</li>
                <li>You can click (and drag) the time range widget to check out more details on that time.</li>
                <li>The time range shows 3 values: top light green bars are the number of event logs, bottom dark green bars are the number of searches,
                red lines are the number of errors. The graphs uses 3 different scales.</li>
                <li>Logs uses UTC time (avoiding issue with day light saving time).</li>
                <li>The current UTC time is displayed on the bottom left corner of the screen.</li>
                <li>Each bar of the time range is a 10 min range.</li>
            </ul>
            <h2>Queries:</h2>
            <div id="queriesHelp"></div>
            <h2>EPICS Debug:</h2>
            By clicking on the hamburger menu (on the top left) and then on the entry "EPICS Debug" it is possible to try to debug if
            there is an error with a gateway or if the gateway seems to react in an abnormal way.<br />
            <br />
            To use the tool, an EPICS channel name must be given and a gateway selected. Once this is done, by pressing the button "Run test"
            a couple of tests will be run on the gateway machine. At the end of the tests, a summary displays what seems to be the state of the gateway.<br />
            <br />
            In case of error as status, it's advice to re-run the test, and only then if the error persist contact the support.
            <h2>Data retention:</h2>
            Data is kept for a max. time of 5 days.
            <div class="button topClose" onclick="$('#helpView').hide();">Close</div>
        </div>
    </div>
    <div id="hamburgerMenu">
        <div onclick="Main.LogStatistics()">Log Statistics</div>
        <div onclick="Main.GWVersions()">Gateway Versions</div>
        <div onclick="EpicsDebug.Show()">EPICS Debug</div>
        <!--<div>Subscription</div>-->
    </div>
    <script src="Scripts/jquery-3.3.1.min.js"></script>
    <script src="Scripts/kendo.all.min.js"></script>
    <script src="main.js"></script>
</body>
</html>